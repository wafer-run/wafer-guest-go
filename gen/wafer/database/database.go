// Package database provides the WIT-generated database service imports.
// In production, this file is generated by wit-bindgen-go from wafer-wit/wit/database.wit.
// This stub defines the types and function signatures matching the WIT interface.
package database

// DbRecord is a database record with an ID and JSON-encoded data.
type DbRecord struct {
	ID   string
	Data string // JSON-encoded map
}

// RecordList is a paginated list of records.
type RecordList struct {
	Records    []DbRecord
	TotalCount int64
	Page       int64
	PageSize   int64
}

// FilterOp enumerates filter operators.
type FilterOp uint8

const (
	FilterOpEq FilterOp = iota
	FilterOpNeq
	FilterOpGt
	FilterOpGte
	FilterOpLt
	FilterOpLte
	FilterOpLike
	FilterOpIn
	FilterOpIsNull
	FilterOpIsNotNull
)

// Filter is a single filter condition.
type Filter struct {
	Field    string
	Operator FilterOp
	Value    string // JSON-encoded value
}

// SortField is a sort directive.
type SortField struct {
	Field string
	Desc  bool
}

// ListOptions configures a list query.
type ListOptions struct {
	Filters []Filter
	Sort    []SortField
	Limit   int64
	Offset  int64
}

// DatabaseError enumerates database errors.
type DatabaseError uint8

const (
	DatabaseErrorNotFound DatabaseError = iota
	DatabaseErrorInternal
)

func (e DatabaseError) Error() string {
	switch e {
	case DatabaseErrorNotFound:
		return "not found"
	case DatabaseErrorInternal:
		return "internal error"
	default:
		return "unknown error"
	}
}

// These functions are the WIT-generated host imports.
// They will be populated by wit-bindgen-go generated code.
// For now they are stubs that will be linked at compile time via //go:wasmimport.

var Get func(collection string, id string) (DbRecord, error)
var List func(collection string, options ListOptions) (RecordList, error)
var Create func(collection string, data string) (DbRecord, error)
var Update func(collection string, id string, data string) (DbRecord, error)
var Delete func(collection string, id string) error
var Count func(collection string, filters []Filter) (int64, error)
var QueryRaw func(query string, args string) ([]DbRecord, error)
var ExecRaw func(query string, args string) (int64, error)
